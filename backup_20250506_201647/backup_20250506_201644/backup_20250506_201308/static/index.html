<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Risk Repository Chatbot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>MIT AI Risk Repository Chatbot</h1>
            <button id="reset-btn">Reset Conversation</button>
        </div>
        
        <div class="chat-messages" id="chat-messages">
            <div class="message bot-message">
                <div class="message-content">
                    Hello! I'm the AI Risk Repository assistant. How can I help you navigate the repository today?
                </div>
            </div>
        </div>
        
        <div class="user-input">
            <input type="text" id="message-input" placeholder="Type your message here...">
            <button id="send-btn">Send</button>
        </div>
    </div>

    <script src="app.js"></script>
    
    <!-- Fallback inline script -->
    <script>
        console.log("Inline script running");
        
        // Check if button handlers are working
        setTimeout(function() {
            const sendBtn = document.getElementById('send-btn');
            const resetBtn = document.getElementById('reset-btn');
            
            if (sendBtn && !sendBtn.onclick) {
                console.log("Adding inline handler to send button");
                
                sendBtn.onclick = function() {
                    console.log("Send button clicked (inline)");
                    const message = document.getElementById('message-input').value.trim();
                    if (message) {
                        // Add user message
                        const chatMessages = document.getElementById('chat-messages');
                        const msgDiv = document.createElement('div');
                        msgDiv.className = 'message user-message';
                        msgDiv.innerHTML = `<div class="message-content">${message}</div>`;
                        chatMessages.appendChild(msgDiv);
                        
                        // Clear input
                        document.getElementById('message-input').value = '';
                        
                        // Add a temporary response
                        const botDiv = document.createElement('div');
                        botDiv.className = 'message bot-message';
                        botDiv.innerHTML = `<div class="message-content">Processing your request... (using fallback JS)</div>`;
                        chatMessages.appendChild(botDiv);
                        
                        // Scroll to bottom
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                        
                        // Make simple fetch request
                        fetch(window.location.origin + '/api/chat', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ 
                                message: message,
                                conversation_id: 'default'
                            })
                        })
                        .then(res => res.json())
                        .then(data => {
                            console.log("Response:", data);
                            botDiv.innerHTML = `<div class="message-content">${data.response}</div>`;
                        })
                        .catch(err => {
                            console.error("Error:", err);
                            botDiv.innerHTML = `<div class="message-content">Error: ${err.message}</div>`;
                        });
                    }
                };
            }
        }, 1000);
    </script>
</body>
</html>